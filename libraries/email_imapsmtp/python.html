

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Python API &mdash; RPA Framework  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=6d878a92" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../../_static/doctools.js?v=9a2dae69"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/iframeResizer.min.js?v=a9f7dbe8"></script>
      <script src="../../_static/custom.js?v=9670dbcd"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Excel.Application" href="../excel_application/index.html" />
    <link rel="prev" title="Email.ImapSmtp" href="index.html" />
	<!-- Cookie consent -->
<link async rel="stylesheet" type="text/css" href="../../_static/cookie.css"/>
<script async src="../../_static/cookie.js"></script>
<!-- Robocorp banner -->
<link async rel="stylesheet" type="text/css" href="../../_static/robocorp.css"/>
<script async src="../../_static/robocorp.js"></script>
<!--            -->
	<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-151433780-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-151433780-3');
</script>
<!--            -->

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            RPA Framework
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Libraries</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../archive/index.html">Archive</a></li>
<li class="toctree-l1"><a class="reference internal" href="../browser/index.html">Browser</a></li>
<li class="toctree-l1"><a class="reference internal" href="../browser_playwright/index.html">Browser.Playwright</a></li>
<li class="toctree-l1"><a class="reference internal" href="../browser_selenium/index.html">Browser.Selenium</a></li>
<li class="toctree-l1"><a class="reference internal" href="../calendar/index.html">Calendar</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cloud_aws/index.html">Cloud.AWS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cloud_azure/index.html">Cloud.Azure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cloud_google/index.html">Cloud.Google</a></li>
<li class="toctree-l1"><a class="reference internal" href="../crypto/index.html">Crypto</a></li>
<li class="toctree-l1"><a class="reference internal" href="../database/index.html">Database</a></li>
<li class="toctree-l1"><a class="reference internal" href="../desktop/index.html">Desktop</a></li>
<li class="toctree-l1"><a class="reference internal" href="../desktop_clipboard/index.html">Desktop.Clipboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="../desktop_operatingsystem/index.html">Desktop.OperatingSystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../desktop_windows/index.html">Desktop.Windows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../documentai/index.html">DocumentAI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../documentai_base64ai/index.html">DocumentAI.Base64AI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../documentai_nanonets/index.html">DocumentAI.Nanonets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../email_exchange/index.html">Email.Exchange</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Email.ImapSmtp</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Python API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../excel_application/index.html">Excel.Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="../excel_files/index.html">Excel.Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../filesystem/index.html">FileSystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ftp/index.html">FTP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../http/index.html">HTTP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hubspot/index.html">HubSpot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../images/index.html">Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="../javaaccessbridge/index.html">JavaAccessBridge</a></li>
<li class="toctree-l1"><a class="reference internal" href="../json/index.html">JSON</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mfa/index.html">MFA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../msgraph/index.html">MSGraph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../netsuite/index.html">Netsuite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notifier/index.html">Notifier</a></li>
<li class="toctree-l1"><a class="reference internal" href="../openai/index.html">OpenAI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../outlook_application/index.html">Outlook.Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pdf/index.html">PDF</a></li>
<li class="toctree-l1"><a class="reference internal" href="../robocorp_process/index.html">Robocorp.Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../robocorp_storage/index.html">Robocorp.Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../robocorp_vault/index.html">Robocorp.Vault</a></li>
<li class="toctree-l1"><a class="reference internal" href="../robocorp_workitems/index.html">Robocorp.WorkItems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../robotloglistener/index.html">RobotLogListener</a></li>
<li class="toctree-l1"><a class="reference internal" href="../salesforce/index.html">Salesforce</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sap/index.html">SAP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../slack/index.html">Slack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../smartsheet/index.html">Smartsheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tables/index.html">Tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tasks/index.html">Tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../twitter/index.html">Twitter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../windows/index.html">Windows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../word_application/index.html">Word.Application</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Project</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../releasenotes.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/guide.html">Contribution guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/conventions.html">Project conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/todos.html">TODO</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">RPA Framework</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Email.ImapSmtp</a></li>
      <li class="breadcrumb-item active">Python API</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/libraries/email_imapsmtp/python.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
	
           <div itemprop="articleBody">
             
  <section id="python-api">
<h1>Python API<a class="headerlink" href="#python-api" title="Link to this heading"></a></h1>
<section id="imapsmtp">
<h2>ImapSmtp<a class="headerlink" href="#imapsmtp" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="RPA.Email.ImapSmtp.ImapSmtp">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">RPA.Email.ImapSmtp.</span></span><span class="sig-name descname"><span class="pre">ImapSmtp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smtp_server</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smtp_port</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">587</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imap_server</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imap_port</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">993</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">account</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">password</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'utf-8'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">provider</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">OAuthProvider</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">OAuthProvider.GOOGLE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tenant</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RPA.Email.ImapSmtp.ImapSmtp" title="Link to this definition"></a></dt>
<dd><p><cite>ImapSmtp</cite> is a library for sending, reading, and deleting emails.
<cite>ImapSmtp</cite> is interfacing with SMTP and IMAP protocols.</p>
<p><strong>*About criteria argument*</strong></p>
<p>Various keywords like <code class="docutils literal notranslate"><span class="pre">List</span> <span class="pre">Messages</span></code> and <code class="docutils literal notranslate"><span class="pre">Move</span> <span class="pre">Messages</span></code> have keyword
argument called <code class="docutils literal notranslate"><span class="pre">criterion</span></code> which can be used to filter emails according
to given criteria.</p>
<p>Syntax needs to according to specification and more information about that
can be read from <a class="reference external" href="https://robocorp.com/docs-robot-framework/development-guide/email/sending-emails-with-gmail-smtp#listing-email-messages-by-criteria">https://robocorp.com/docs-robot-framework/development-guide/email/sending-emails-with-gmail-smtp#listing-email-messages-by-criteria</a></p>
<p><strong>Troubleshooting</strong></p>
<ul>
<li><dl class="simple">
<dt>Authentication error with GMail - “Application-specific password required”</dt><dd><p>See: <a class="reference external" href="https://support.google.com/mail/answer/185833?hl=en">https://support.google.com/mail/answer/185833?hl=en</a></p>
</dd>
</dl>
</li>
<li><dl>
<dt>More secure apps (XOAUTH2 protocol) - Use the OAuth2 flow as in this Portal robot:</dt><dd><p><a class="reference external" href="https://github.com/robocorp/example-oauth-email">example-oauth-email</a></p>
<p>Make sure to specify a <cite>provider</cite> (and optionally a <cite>tenant</cite>) when importing
the library and planning to use this flow.</p>
</dd>
</dl>
</li>
</ul>
<p><strong>Examples</strong></p>
<p><strong>Robot Framework</strong></p>
<p>It is highly recommended to secure your passwords and take care
that they are not stored in version control by mistake.
See <code class="docutils literal notranslate"><span class="pre">RPA.Robocorp.Vault</span></code> to see how to store secrets in
Robocorp Vault.</p>
<p>When sending HTML content with IMG tags, the <code class="docutils literal notranslate"><span class="pre">src</span></code> filenames must match
the base image name given with the <code class="docutils literal notranslate"><span class="pre">images</span></code> parameter.</p>
<div class="highlight-robotframework notranslate"><div class="highlight"><pre><span></span><span class="gh">*** Settings ***</span>
<span class="kn">Library</span><span class="p">     </span><span class="nn">RPA.Email.ImapSmtp</span><span class="p">   </span><span class="s">smtp_server=smtp.gmail.com</span><span class="p">  </span><span class="s">smtp_port=587</span>
<span class="kn">Task Setup</span><span class="p">  </span><span class="nf">Authorize</span><span class="p">  </span><span class="s">account=</span><span class="p">${</span><span class="nv">GMAIL_ACCOUNT</span><span class="p">}  </span><span class="s">password=</span><span class="p">${</span><span class="nv">GMAIL_PASSWORD</span><span class="p">}</span>

<span class="gh">*** Variables ***</span>
<span class="p">${</span><span class="nv">GMAIL_ACCOUNT</span><span class="p">}        </span><span class="s">ACCOUNT_NAME</span>
<span class="p">${</span><span class="nv">GMAIL_PASSWORD</span><span class="p">}       </span><span class="s">APP_PASSWORD</span>
<span class="p">${</span><span class="nv">RECIPIENT_ADDRESS</span><span class="p">}    </span><span class="s">RECIPIENT</span>
<span class="p">${</span><span class="nv">BODY_IMG1</span><span class="p">}            ${</span><span class="nv">IMAGEDIR</span><span class="p">}${</span><span class="nv">/</span><span class="p">}</span><span class="s">approved.png</span>
<span class="p">${</span><span class="nv">BODY_IMG2</span><span class="p">}            ${</span><span class="nv">IMAGEDIR</span><span class="p">}${</span><span class="nv">/</span><span class="p">}</span><span class="s">invoice.png</span>
<span class="p">${</span><span class="nv">EMAIL_BODY</span><span class="p">}     </span><span class="s">&lt;h1&gt;Heading&lt;/h1&gt;&lt;p&gt;Status: &lt;img src=&#39;approved.png&#39; alt=&#39;approved image&#39;/&gt;&lt;/p&gt;</span>
<span class="p">...               </span><span class="s">&lt;p&gt;INVOICE: &lt;img src=&#39;invoice.png&#39; alt=&#39;invoice image&#39;/&gt;&lt;/p&gt;</span>

<span class="gh">*** Tasks ***</span>
<span class="gu">Sending email</span>
<span class="p">    </span><span class="nf">Send Message</span><span class="p">  </span><span class="s">sender=</span><span class="p">${</span><span class="nv">GMAIL_ACCOUNT</span><span class="p">}</span>
<span class="p">    ...           </span><span class="s">recipients=</span><span class="p">${</span><span class="nv">RECIPIENT_ADDRESS</span><span class="p">}</span>
<span class="p">    ...           </span><span class="s">subject=Message from RPA Robot</span>
<span class="p">    ...           </span><span class="s">body=RPA Robot message body</span>

<span class="gu">Sending HTML Email With Image</span>
<span class="p">    [</span><span class="kn">Documentation</span><span class="p">]     </span><span class="s">Sending email with HTML content and attachment</span>
<span class="p">    </span><span class="nf">Send Message</span>
<span class="p">    ...                 </span><span class="s">sender=</span><span class="p">${</span><span class="nv">GMAIL_ACCOUNT</span><span class="p">}</span>
<span class="p">    ...                 </span><span class="s">recipients=</span><span class="p">${</span><span class="nv">RECIPIENT_ADDRESS</span><span class="p">}</span>
<span class="p">    ...                 </span><span class="s">subject=HTML email with body images (2) plus one attachment</span>
<span class="p">    ...                 </span><span class="s">body=</span><span class="p">${</span><span class="nv">EMAIL_BODY</span><span class="p">}</span>
<span class="p">    ...                 </span><span class="s">html=</span><span class="p">${</span><span class="nv">TRUE</span><span class="p">}</span>
<span class="p">    ...                 </span><span class="s">images=</span><span class="p">${</span><span class="nv">BODY_IMG1</span><span class="p">}</span><span class="s">, </span><span class="p">${</span><span class="nv">BODY_IMG2</span><span class="p">}</span>
<span class="p">    ...                 </span><span class="s">attachments=example.png</span>
</pre></div>
</div>
<p><strong>Python</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">RPA.Email.ImapSmtp</span><span class="w"> </span><span class="kn">import</span> <span class="n">ImapSmtp</span>

<span class="n">gmail_account</span> <span class="o">=</span> <span class="s2">&quot;ACCOUNT_NAME&quot;</span>
<span class="n">gmail_password</span> <span class="o">=</span> <span class="s2">&quot;APP_PASSWORD&quot;</span>

<span class="n">mail</span> <span class="o">=</span> <span class="n">ImapSmtp</span><span class="p">(</span><span class="n">smtp_server</span><span class="o">=</span><span class="s2">&quot;smtp.gmail.com&quot;</span><span class="p">,</span> <span class="n">smtp_port</span><span class="o">=</span><span class="mi">587</span><span class="p">)</span>
<span class="n">mail</span><span class="o">.</span><span class="n">authorize</span><span class="p">(</span><span class="n">account</span><span class="o">=</span><span class="n">gmail_account</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">gmail_password</span><span class="p">)</span>
<span class="n">mail</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span>
    <span class="n">sender</span><span class="o">=</span><span class="n">gmail_account</span><span class="p">,</span>
    <span class="n">recipients</span><span class="o">=</span><span class="s2">&quot;RECIPIENT&quot;</span><span class="p">,</span>
    <span class="n">subject</span><span class="o">=</span><span class="s2">&quot;Message from RPA Python&quot;</span><span class="p">,</span>
    <span class="n">body</span><span class="o">=</span><span class="s2">&quot;RPA Python message body&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="RPA.Email.ImapSmtp.ImapSmtp.ROBOT_LIBRARY_DOC_FORMAT">
<span class="sig-name descname"><span class="pre">ROBOT_LIBRARY_DOC_FORMAT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'REST'</span></em><a class="headerlink" href="#RPA.Email.ImapSmtp.ImapSmtp.ROBOT_LIBRARY_DOC_FORMAT" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="RPA.Email.ImapSmtp.ImapSmtp.ROBOT_LIBRARY_SCOPE">
<span class="sig-name descname"><span class="pre">ROBOT_LIBRARY_SCOPE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'GLOBAL'</span></em><a class="headerlink" href="#RPA.Email.ImapSmtp.ImapSmtp.ROBOT_LIBRARY_SCOPE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="RPA.Email.ImapSmtp.ImapSmtp.TO_PROTECT">
<span class="sig-name descname"><span class="pre">TO_PROTECT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['authorize',</span> <span class="pre">'authorize_imap',</span> <span class="pre">'authorize_smtp',</span> <span class="pre">'set_credentials',</span> <span class="pre">'generate_oauth_string',</span> <span class="pre">'get_oauth_token',</span> <span class="pre">'refresh_oauth_token']</span></em><a class="headerlink" href="#RPA.Email.ImapSmtp.ImapSmtp.TO_PROTECT" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="RPA.Email.ImapSmtp.ImapSmtp.add_gmail_labels">
<span class="sig-name descname"><span class="pre">add_gmail_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">criterion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_folder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#RPA.Email.ImapSmtp.ImapSmtp.add_gmail_labels" title="Link to this definition"></a></dt>
<dd><p>Add GMail labels to messages matching criterion and if given,
source folder</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels</strong> – comma separated list of labels to add</p></li>
<li><p><strong>criterion</strong> – label messages matching criterion</p></li>
<li><p><strong>source_folder</strong> – look for messages in this folder, default all folders</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>status of the operation</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-robotframework notranslate"><div class="highlight"><pre><span></span><span class="c">Add Gmail Labels</span><span class="p">  </span><span class="c">customer1</span><span class="p">   </span><span class="c">SUBJECT &quot;order confirmation&quot;</span>
<span class="c">Add Gmail Labels</span><span class="p">  </span><span class="c">wip</span><span class="p">         </span><span class="c">SUBJECT &quot;order confirmation&quot;</span><span class="p">   </span><span class="c">customerfolder</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="RPA.Email.ImapSmtp.ImapSmtp.authorize">
<span class="sig-name descname"><span class="pre">authorize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">account</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">password</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smtp_server</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imap_server</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smtp_port</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imap_port</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_oauth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#RPA.Email.ImapSmtp.ImapSmtp.authorize" title="Link to this definition"></a></dt>
<dd><p>Authorize user to SMTP and IMAP servers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>account</strong> – user account as string, defaults to None</p></li>
<li><p><strong>password</strong> – user password as string, defaults to None</p></li>
<li><p><strong>smtp_server</strong> – SMTP server address, defaults to None</p></li>
<li><p><strong>imap_server</strong> – IMAP server address, defaults to None</p></li>
<li><p><strong>smtp_port</strong> – SMTP server port, defaults to None (587 for SMTP)</p></li>
<li><p><strong>imap_port</strong> – IMAP server port, defaults to None</p></li>
<li><p><strong>is_oauth</strong> – Use XOAUTH2 protocol with a base64 encoded OAuth2 string as
<cite>password</cite></p></li>
</ul>
</dd>
</dl>
<p>Will use separately set credentials or those given in keyword call.</p>
<p>Example:</p>
<div class="highlight-robotframework notranslate"><div class="highlight"><pre><span></span><span class="c">Authorize</span><span class="p">    </span><span class="c">${username}</span><span class="p">   </span><span class="c">${password}</span><span class="p">  </span><span class="c">smtp_server=smtp.gmail.com</span><span class="p">  </span><span class="c">smtp_port=587</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="RPA.Email.ImapSmtp.ImapSmtp.authorize_imap">
<span class="sig-name descname"><span class="pre">authorize_imap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">account</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">password</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imap_server</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imap_port</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_oauth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#RPA.Email.ImapSmtp.ImapSmtp.authorize_imap" title="Link to this definition"></a></dt>
<dd><p>Authorize to IMAP server.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>account</strong> – IMAP account name, defaults to None</p></li>
<li><p><strong>password</strong> – IMAP account password, defaults to None</p></li>
<li><p><strong>imap_server</strong> – IMAP server address, defaults to None</p></li>
<li><p><strong>imap_port</strong> – IMAP server port, defaults to None</p></li>
<li><p><strong>is_oauth</strong> – Use XOAUTH2 protocol with a base64 encoded OAuth2 string as
<cite>password</cite></p></li>
</ul>
</dd>
</dl>
<p>Can be called without giving any parameters if library
has been initialized with necessary information and/or
keyword <code class="docutils literal notranslate"><span class="pre">Set</span> <span class="pre">Credentials</span></code> has been called.</p>
<p>Example:</p>
<div class="highlight-robotframework notranslate"><div class="highlight"><pre><span></span><span class="c">Authorize IMAP</span><span class="p">    </span><span class="c">${username}</span><span class="p">   </span><span class="c">${password}</span><span class="p">  </span><span class="c">imap.gmail.com</span><span class="p">  </span><span class="c">993</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="RPA.Email.ImapSmtp.ImapSmtp.authorize_smtp">
<span class="sig-name descname"><span class="pre">authorize_smtp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">account</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">password</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smtp_server</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smtp_port</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_oauth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#RPA.Email.ImapSmtp.ImapSmtp.authorize_smtp" title="Link to this definition"></a></dt>
<dd><p>Authorize to SMTP server.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>account</strong> – SMTP account name, defaults to None</p></li>
<li><p><strong>password</strong> – SMTP account password, defaults to None</p></li>
<li><p><strong>smtp_server</strong> – SMTP server address, defaults to None</p></li>
<li><p><strong>smtp_port</strong> – SMTP server port, defaults to None (587 for SMTP)</p></li>
<li><p><strong>is_oauth</strong> – Use XOAUTH2 protocol with a base64 encoded OAuth2 string as
<cite>password</cite></p></li>
</ul>
</dd>
</dl>
<p>Can be called without giving any parameters if library
has been initialized with necessary information and/or
keyword <code class="docutils literal notranslate"><span class="pre">Set</span> <span class="pre">Credentials</span></code> has been called.</p>
<p>Example:</p>
<div class="highlight-robotframework notranslate"><div class="highlight"><pre><span></span><span class="c">Authorize SMTP</span><span class="p">    </span><span class="c">${username}</span><span class="p">   </span><span class="c">${password}</span><span class="p">  </span><span class="c">smtp.gmail.com</span><span class="p">  </span><span class="c">587</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="RPA.Email.ImapSmtp.ImapSmtp.convert_eml_file_into_message">
<span class="sig-name descname"><span class="pre">convert_eml_file_into_message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eml_filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_attachments_directory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RPA.Email.ImapSmtp.ImapSmtp.convert_eml_file_into_message" title="Link to this definition"></a></dt>
<dd><p>Converts EML file into message dictionary.</p>
<p>Returned dictionary contains:</p>
<ul class="simple">
<li><p><strong>headers</strong> of the email</p></li>
<li><p><strong>attachments</strong> the filenames of the attachments or if attachments
have been saved then they are absolute filepaths to each attachment</p></li>
<li><p><strong>body_text</strong> is the TEXT formatted content of the email body</p></li>
<li><p><strong>body_html</strong> is the HTML formatted content of the email body</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eml_filepath</strong> – filepath to the EML file</p></li>
<li><p><strong>save_attachments_directory</strong> – path to the directory where possible
attachments will be saved to, if not given then attachment filenames are
returned in a list of the return dictionary in the key ‘attachments’</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dictionary containing information aboutthe EML message</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="RPA.Email.ImapSmtp.ImapSmtp.create_folder">
<span class="sig-name descname"><span class="pre">create_folder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#RPA.Email.ImapSmtp.ImapSmtp.create_folder" title="Link to this definition"></a></dt>
<dd><p>Create email folder</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>folder_name</strong> – name for the new folder</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if operation was successful, False if not</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-robotframework notranslate"><div class="highlight"><pre><span></span><span class="c">Create Folder</span><span class="p">   </span><span class="c">filtered</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="RPA.Email.ImapSmtp.ImapSmtp.delete_folder">
<span class="sig-name descname"><span class="pre">delete_folder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#RPA.Email.ImapSmtp.ImapSmtp.delete_folder" title="Link to this definition"></a></dt>
<dd><p>Delete email folder</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>folder_name</strong> – current folder name</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if operation was successful, False if not</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-robotframework notranslate"><div class="highlight"><pre><span></span><span class="c">Delete Folder</span><span class="p">   </span><span class="c">filtered</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="RPA.Email.ImapSmtp.ImapSmtp.delete_message">
<span class="sig-name descname"><span class="pre">delete_message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">criterion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_folder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#RPA.Email.ImapSmtp.ImapSmtp.delete_message" title="Link to this definition"></a></dt>
<dd><p>Delete single message from server based on criterion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>criterion</strong> – filter messages based on this search, can also be a
message dictionary</p></li>
<li><p><strong>source_folder</strong> – defaults to already selected folder, but can be
set to delete message in a specific folder</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if success, False if not</p>
</dd>
</dl>
<p>If criterion does not return exactly 1 message then delete is not done.</p>
<p>Example:</p>
<div class="highlight-robotframework notranslate"><div class="highlight"><pre><span></span><span class="c">Delete Message</span><span class="p">  </span><span class="c">SUBJECT &quot;Greetings RPA developer&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="RPA.Email.ImapSmtp.ImapSmtp.delete_messages">
<span class="sig-name descname"><span class="pre">delete_messages</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">criterion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_folder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#RPA.Email.ImapSmtp.ImapSmtp.delete_messages" title="Link to this definition"></a></dt>
<dd><p>Delete messages from server based on criterion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>criterion</strong> – filter messages based on this search, can also be a
list of message dictionaries</p></li>
<li><p><strong>limit</strong> – maximum number of message to delete</p></li>
<li><p><strong>source_folder</strong> – defaults to already selected folder, but can be
set to delete message in a specific folder</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if success, False if not</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-robotframework notranslate"><div class="highlight"><pre><span></span><span class="c">Delete Messages</span><span class="p">  </span><span class="c">SUBJECT Greetings</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="RPA.Email.ImapSmtp.ImapSmtp.do_message_actions">
<span class="sig-name descname"><span class="pre">do_message_actions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">criterion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">actions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_folder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_folder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#RPA.Email.ImapSmtp.ImapSmtp.do_message_actions" title="Link to this definition"></a></dt>
<dd><p>Do actions to messages matching criterion and if given,
source folder</p>
<p>Actions can be:</p>
<ul class="simple">
<li><p>msg_copy</p></li>
<li><p>msg_delete</p></li>
<li><p>msg_flag</p></li>
<li><p>msg_unflag</p></li>
<li><p>msg_read</p></li>
<li><p>msg_unread</p></li>
<li><p>msg_save</p></li>
<li><p>msg_attachment_save</p></li>
<li><p>glabel_add</p></li>
<li><p>glabel_remove</p></li>
</ul>
<p>Result object contains following attributes:</p>
<ul class="simple">
<li><p>actions_done, number of messages on which action was performed</p></li>
<li><p>message_count, number of messages matching criterion</p></li>
<li><p>ids, message ids matching criterion</p></li>
<li><p>uids, dictionary of message uids and message content</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>criterion</strong> – perform actions on messages matching this</p></li>
<li><p><strong>actions</strong> – list of actions to perform on matching messages</p></li>
<li><p><strong>source_folder</strong> – look for messages in this folder, default all folders</p></li>
<li><p><strong>target_folder</strong> – can be file path or email folder
(for example action: msg_copy)</p></li>
<li><p><strong>labels</strong> – comma separated list of labels (for example action: glabel_add)</p></li>
<li><p><strong>limit</strong> – maximum number of messages (for example action: msg_delete)</p></li>
<li><p><strong>overwrite</strong> – to control if file should overwrite
(for example action: msg_attachment_save)</p></li>
<li><p><strong>prefix</strong> – prefix to be added into filename (for example: msg_save)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>result object</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-robotframework notranslate"><div class="highlight"><pre><span></span><span class="c">${actions}=</span><span class="p">   </span><span class="c">Create List</span><span class="p">  </span><span class="c">msg_unflag</span><span class="p">  </span><span class="c">msg_read</span><span class="p">  </span><span class="c">msg_save</span><span class="p">  </span><span class="c">msg_attachment_save</span>
<span class="c">Do Message Actions</span><span class="p">    </span><span class="c">SUBJECT &quot;Order confirmation&quot;</span>
<span class="c">...</span><span class="p">                   </span><span class="c">${actions}</span>
<span class="c">...</span><span class="p">                   </span><span class="c">source_folder=XXX</span>
<span class="c">...</span><span class="p">                   </span><span class="c">target_folder=${CURDIR}</span>
<span class="c">...</span><span class="p">                   </span><span class="c">overwrite=True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="RPA.Email.ImapSmtp.ImapSmtp.email_to_document">
<span class="sig-name descname"><span class="pre">email_to_document</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">BinaryIO</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RPA.Email.ImapSmtp.ImapSmtp.email_to_document" title="Link to this definition"></a></dt>
<dd><p>Convert a raw e-mail into a Word document.</p>
<p>This keyword extracts the HTML (or Text) content from the passed input e-mail
and saves it into docx format at the provided output path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_source</strong> – Path, bytes or file-like object with the input raw e-mail
content</p></li>
<li><p><strong>output_path</strong> – Where to save the output docx file</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<p><strong>Robot Framework</strong></p>
<div class="highlight-robotframework notranslate"><div class="highlight"><pre><span></span><span class="c">Convert email to docx</span>
<span class="p">    </span><span class="c">${mail_file} =</span><span class="p">     </span><span class="c">Get Work Item File</span><span class="p">    </span><span class="c">mail.eml</span>
<span class="p">    </span><span class="c">Email To Document</span><span class="p">    </span><span class="c">${mail_file}</span><span class="p">    </span><span class="c">${OUTPUT_DIR}${/}mail.docx</span>
</pre></div>
</div>
<p><strong>Python</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">RPA.Email.ImapSmtp</span><span class="w"> </span><span class="kn">import</span> <span class="n">ImapSmtp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">RPA.Robocorp.WorkItems</span><span class="w"> </span><span class="kn">import</span> <span class="n">WorkItems</span>

<span class="n">lib_work</span> <span class="o">=</span> <span class="n">WorkItems</span><span class="p">()</span>
<span class="n">lib_mail</span> <span class="o">=</span> <span class="n">ImapSmtp</span><span class="p">()</span>

<span class="k">def</span><span class="w"> </span><span class="nf">convert_email_to_docx</span><span class="p">():</span>
    <span class="n">lib_work</span><span class="o">.</span><span class="n">get_input_work_item</span><span class="p">()</span>
    <span class="n">mail_file</span> <span class="o">=</span> <span class="n">lib_work</span><span class="o">.</span><span class="n">get_work_item_file</span><span class="p">(</span><span class="s2">&quot;mail.eml&quot;</span><span class="p">)</span>
    <span class="n">lib_mail</span><span class="o">.</span><span class="n">email_to_document</span><span class="p">(</span><span class="n">mail_file</span><span class="p">,</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;./output&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;mail.docx&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="RPA.Email.ImapSmtp.ImapSmtp.flag_messages">
<span class="sig-name descname"><span class="pre">flag_messages</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">criterion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unflag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#RPA.Email.ImapSmtp.ImapSmtp.flag_messages" title="Link to this definition"></a></dt>
<dd><p>Mark messages as <cite>flagged</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>criterion</strong> – mark messages matching criterion</p></li>
<li><p><strong>unflag</strong> – to mark messages as not <cite>flagged</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>successful operations (int), matching messages (int)</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-robotframework notranslate"><div class="highlight"><pre><span></span><span class="c">${flagged}</span><span class="p">  </span><span class="c">${oftotal}</span><span class="p">    </span><span class="c">Flag Messages</span><span class="p">   </span><span class="c">SUBJECT rpa</span>
<span class="c">${unflagged}</span><span class="p">  </span><span class="c">${oftotal}</span><span class="p">  </span><span class="c">Flag Messages</span><span class="p">   </span><span class="c">SUBJECT rpa</span><span class="p">  </span><span class="c">unflag=True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="RPA.Email.ImapSmtp.ImapSmtp.generate_oauth_string">
<span class="sig-name descname"><span class="pre">generate_oauth_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">username</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">access_token</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#RPA.Email.ImapSmtp.ImapSmtp.generate_oauth_string" title="Link to this definition"></a></dt>
<dd><p>Generate and return an OAuth2 string compatible with the IMAP/POP/SMTP
XOAUTH2 protocol.</p>
<p>This string usually gets passed to the <code class="docutils literal notranslate"><span class="pre">Authorize</span></code> keyword as <cite>password</cite> when
<cite>is_oauth=${True}</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>username</strong> – The e-mail address you’re going to send the e-mail with.</p></li>
<li><p><strong>access_token</strong> – Access token string found in the dictionary obtained with
<code class="docutils literal notranslate"><span class="pre">Get</span> <span class="pre">OAuth</span> <span class="pre">Token</span></code> or <code class="docutils literal notranslate"><span class="pre">Refresh</span> <span class="pre">OAuth</span> <span class="pre">Token</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Base64 encoded string packing these credentials and replacing the
legacy <cite>password</cite> when enabling the OAuth2 flow.</p>
</dd>
</dl>
<p><strong>Example: Robot Framework</strong></p>
<div class="highlight-robotframework notranslate"><div class="highlight"><pre><span></span><span class="gh">*** Tasks ***</span>
<span class="gu">Authorize ImapSmtp</span>
<span class="p">    ${</span><span class="nv">password</span><span class="p">} =   </span><span class="nf">Generate OAuth String</span><span class="p">    ${</span><span class="nv">username</span><span class="p">}</span>
<span class="p">    ...    ${</span><span class="nv">token</span><span class="p">}[</span><span class="nv">access_token</span><span class="p">]</span>
<span class="p">    </span><span class="nf">Authorize</span><span class="p">    </span><span class="s">account=</span><span class="p">${</span><span class="nv">username</span><span class="p">}    </span><span class="s">is_oauth=</span><span class="p">${</span><span class="nv">True</span><span class="p">}</span>
<span class="p">    ...     </span><span class="s">password=</span><span class="p">${</span><span class="nv">password</span><span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="RPA.Email.ImapSmtp.ImapSmtp.generate_oauth_url">
<span class="sig-name descname"><span class="pre">generate_oauth_url</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">client_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#RPA.Email.ImapSmtp.ImapSmtp.generate_oauth_url" title="Link to this definition"></a></dt>
<dd><p>Generates an authorization URL which must be opened by the user to start the
OAuth2 flow and obtain an authorization code as response.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>client_id</strong> – Client app ID. (generated by the provider)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Authorization URL string not containing any sensitive info in it.</p>
</dd>
</dl>
<p><strong>Example: Robot Framework</strong></p>
<div class="highlight-robotframework notranslate"><div class="highlight"><pre><span></span><span class="gh">*** Tasks ***</span>
<span class="gu">Start OAuth Flow</span>
<span class="p">    ${</span><span class="nv">auth_url</span><span class="p">} =    </span><span class="nf">Generate OAuth URL</span>
<span class="p">    ...     </span><span class="s">client_id=810482312368-19htmcgcj*******googleusercontent.com</span>
<span class="p">    </span><span class="nf">Log</span><span class="p">     </span><span class="s">Start OAuth2 flow: </span><span class="p">${</span><span class="nv">auth_url</span><span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="RPA.Email.ImapSmtp.ImapSmtp.get_decoded_email_body">
<span class="sig-name descname"><span class="pre">get_decoded_email_body</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">html_first</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#RPA.Email.ImapSmtp.ImapSmtp.get_decoded_email_body" title="Link to this definition"></a></dt>
<dd><p>Decodes email body and extracts its text/html content.</p>
<p>Automatically detects character set if the header is not set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>message</strong> – Raw 7-bit message body input e.g. from <cite>imaplib</cite>. Double
encoded in quoted-printable and latin-1</p></li>
<li><p><strong>html_first</strong> – Prioritize html extraction over text when this is True</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Message body as unicode string and a boolean telling if the message
has attachments</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="RPA.Email.ImapSmtp.ImapSmtp.get_folder_list">
<span class="sig-name descname"><span class="pre">get_folder_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subdirectory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#RPA.Email.ImapSmtp.ImapSmtp.get_folder_list" title="Link to this definition"></a></dt>
<dd><p>Get list of folders on the server</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subdirectory</strong> – list subdirectories for this folder</p></li>
<li><p><strong>pattern</strong> – list folders matching this pattern</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list of folders</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-robotframework notranslate"><div class="highlight"><pre><span></span><span class="c">@{folders}</span><span class="p">  </span><span class="c">Get Folder List</span>
<span class="c">@{folders}</span><span class="p">  </span><span class="c">Get Folder List</span><span class="p">  </span><span class="c">pattern=important</span>
<span class="c">@{folders}</span><span class="p">  </span><span class="c">Get Folder List</span><span class="p">  </span><span class="c">subdirectory=sub</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="RPA.Email.ImapSmtp.ImapSmtp.get_oauth_token">
<span class="sig-name descname"><span class="pre">get_oauth_token</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">client_secret</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">response_url</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#RPA.Email.ImapSmtp.ImapSmtp.get_oauth_token" title="Link to this definition"></a></dt>
<dd><p>Exchanges the code obtained previously with <code class="docutils literal notranslate"><span class="pre">Generate</span> <span class="pre">OAuth</span> <span class="pre">URL</span></code> for a
token.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>client_secret</strong> – Client app secret. (generated by the provider)</p></li>
<li><p><strong>response_url</strong> – The final URL containing the authorization <cite>code</cite> found in
the address bar after authenticating and authorizing the Client app
through the authorization URL.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing the access &amp; refresh token, plus metadata.</p>
</dd>
</dl>
<p><strong>Example: Robot Framework</strong></p>
<div class="highlight-robotframework notranslate"><div class="highlight"><pre><span></span><span class="gh">*** Tasks ***</span>
<span class="gu">Finish OAuth Flow</span>
<span class="p">    ${</span><span class="nv">token</span><span class="p">} =      </span><span class="nf">Get OAuth Token</span>
<span class="p">    ...     </span><span class="s">client_secret=GOCSPX-******mqZAW89</span>
<span class="p">    ...     </span><span class="s">response_url=</span><span class="p">${</span><span class="nv">resp_url</span><span class="p">}  </span><span class="c"># redirect of `Generate OAuth URL`</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="RPA.Email.ImapSmtp.ImapSmtp.list_messages">
<span class="sig-name descname"><span class="pre">list_messages</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">criterion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_folder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">readonly</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#RPA.Email.ImapSmtp.ImapSmtp.list_messages" title="Link to this definition"></a></dt>
<dd><p>Return list of messages matching criterion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>criterion</strong> – list emails matching this, defaults to “”</p></li>
<li><p><strong>source_folder</strong> – list messages from this folder</p></li>
<li><p><strong>readonly</strong> – set False if you want to mark matching messages as read</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list of messages</p>
</dd>
</dl>
<p><em>Note.</em> listing messages without <cite>source_folder</cite> might take a long time</p>
<p>Example:</p>
<div class="highlight-robotframework notranslate"><div class="highlight"><pre><span></span><span class="c">@{emails}</span><span class="p">  </span><span class="c">List Messages</span><span class="p">  </span><span class="c">SUBJECT &quot;rpa task&quot;</span>
<span class="c">FOR</span><span class="p">  </span><span class="c">${email}</span><span class="p">  </span><span class="c">IN</span><span class="p">  </span><span class="c">@{EMAILS}</span>
<span class="p">    </span><span class="c">Log</span><span class="p">  </span><span class="c">${email}[Subject]</span>
<span class="p">    </span><span class="c">Log</span><span class="p">  </span><span class="c">${email}[From]</span>
<span class="p">    </span><span class="c">Log</span><span class="p">  </span><span class="c">${email}[Date]</span>
<span class="p">    </span><span class="c">Log</span><span class="p">  </span><span class="c">${email}[Delivered-To]</span>
<span class="p">    </span><span class="c">Log</span><span class="p">  </span><span class="c">${email}[Received]</span>
<span class="p">    </span><span class="c">Log</span><span class="p">  </span><span class="c">${email}[Has-Attachments]</span>
<span class="p">    </span><span class="c">Log</span><span class="p">  </span><span class="c">${email}[uid]</span>
<span class="c">END</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="RPA.Email.ImapSmtp.ImapSmtp.mark_as_read">
<span class="sig-name descname"><span class="pre">mark_as_read</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">criterion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unread</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#RPA.Email.ImapSmtp.ImapSmtp.mark_as_read" title="Link to this definition"></a></dt>
<dd><p>Mark messages as <cite>read</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>criterion</strong> – mark messages matching criterion</p></li>
<li><p><strong>unread</strong> – to mark messages as not <cite>read</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>successful operations (int), matching messages (int)</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-robotframework notranslate"><div class="highlight"><pre><span></span><span class="c">${read}</span><span class="p">  </span><span class="c">${oftotal}</span><span class="p">  </span><span class="c">Mark As Read</span><span class="p">   </span><span class="c">SUBJECT rpa</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="RPA.Email.ImapSmtp.ImapSmtp.mark_as_unread">
<span class="sig-name descname"><span class="pre">mark_as_unread</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">criterion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#RPA.Email.ImapSmtp.ImapSmtp.mark_as_unread" title="Link to this definition"></a></dt>
<dd><p>Mark messages as not <cite>read</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>criterion</strong> – mark messages matching criterion</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>successful operations (int), matching messages (int)</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-robotframework notranslate"><div class="highlight"><pre><span></span><span class="c">${unread}</span><span class="p">  </span><span class="c">${oftotal}</span><span class="p">  </span><span class="c">Mark As Unread</span><span class="p">   </span><span class="c">SUBJECT rpa</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="RPA.Email.ImapSmtp.ImapSmtp.move_messages">
<span class="sig-name descname"><span class="pre">move_messages</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">criterion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_folder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_folder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#RPA.Email.ImapSmtp.ImapSmtp.move_messages" title="Link to this definition"></a></dt>
<dd><p>Move messages from source folder to target folder</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>criterion</strong> – move messages matching criterion</p></li>
<li><p><strong>source_folder</strong> – location of the messages, default <cite>INBOX</cite></p></li>
<li><p><strong>target_folder</strong> – where messages should be move into</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if all move operations succeeded, False if not</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-robotframework notranslate"><div class="highlight"><pre><span></span><span class="c">${result}=</span><span class="p">    </span><span class="c">Move Messages</span>
<span class="c">...</span><span class="p">    </span><span class="c">criterion=SUBJECT &quot;order confirmation 32&quot;</span>
<span class="c">...</span><span class="p">    </span><span class="c">target_folder=yyy</span>

<span class="c">${result}=</span><span class="p">    </span><span class="c">Move Messages</span>
<span class="c">...</span><span class="p">    </span><span class="c">criterion=ALL</span>
<span class="c">...</span><span class="p">    </span><span class="c">source_folder=yyy</span>
<span class="c">...</span><span class="p">    </span><span class="c">target_folder=XXX</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="RPA.Email.ImapSmtp.ImapSmtp.move_messages_by_ids">
<span class="sig-name descname"><span class="pre">move_messages_by_ids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_folder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_folder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_gmail_search</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#RPA.Email.ImapSmtp.ImapSmtp.move_messages_by_ids" title="Link to this definition"></a></dt>
<dd><p>Move message by their Message-ID’s from source folder to target folder</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>message_ids</strong> – one Message-ID as string or list of Message-IDs</p></li>
<li><p><strong>source_folder</strong> – location of the messages, default <cite>INBOX</cite></p></li>
<li><p><strong>target_folder</strong> – where messages should be move into</p></li>
<li><p><strong>use_gmail_search</strong> – set to True to use <cite>Rfc822msgid</cite> search, default
is <cite>HEADER Message-ID</cite> search</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if all move operations succeeded, False if not</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="RPA.Email.ImapSmtp.ImapSmtp.refresh_oauth_token">
<span class="sig-name descname"><span class="pre">refresh_oauth_token</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">client_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client_secret</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">token</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#RPA.Email.ImapSmtp.ImapSmtp.refresh_oauth_token" title="Link to this definition"></a></dt>
<dd><p>Refreshes the token as the access one usually expires after 1h and the
refresh one never expires. (as long as it doesn’t get revoked)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>client_id</strong> – Client app ID. (generated by the provider)</p></li>
<li><p><strong>client_secret</strong> – Client app secret. (generated by the provider)</p></li>
<li><p><strong>token</strong> – Full token dictionary previously obtained with
<code class="docutils literal notranslate"><span class="pre">Get</span> <span class="pre">OAuth</span> <span class="pre">Token</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A token dictionary containing a new access token and updated
metadata.</p>
</dd>
</dl>
<p><strong>Example: Robot Framework</strong></p>
<div class="highlight-robotframework notranslate"><div class="highlight"><pre><span></span><span class="gh">*** Tasks ***</span>
<span class="gu">Refresh OAuth Flow</span>
<span class="p">    ${</span><span class="nv">token</span><span class="p">} =      </span><span class="nf">Refresh OAuth Token</span>
<span class="p">    ...     </span><span class="s">client_id=810482312368-19htmcgcj*******googleusercontent.com</span>
<span class="p">    ...     </span><span class="s">client_secret=GOCSPX-******mqZAW89</span>
<span class="p">    ...     </span><span class="s">token=</span><span class="p">${</span><span class="nv">token</span><span class="p">}  </span><span class="c"># from `Get OAuth Token`</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="RPA.Email.ImapSmtp.ImapSmtp.remove_gmail_labels">
<span class="sig-name descname"><span class="pre">remove_gmail_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">criterion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_folder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#RPA.Email.ImapSmtp.ImapSmtp.remove_gmail_labels" title="Link to this definition"></a></dt>
<dd><p>Remove GMail labels to messages matching criterion and if given,
source folder</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels</strong> – comma separated list of labels to remove</p></li>
<li><p><strong>criterion</strong> – unlabel messages matching criterion</p></li>
<li><p><strong>source_folder</strong> – look for messages in this folder, default all folders</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>status of the operation</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-robotframework notranslate"><div class="highlight"><pre><span></span><span class="c">Remove Gmail Labels</span><span class="p">  </span><span class="c">wip</span><span class="p">  </span><span class="c">SUBJECT &quot;order confirmation&quot;</span>
<span class="c">Remove Gmail Labels</span><span class="p">  </span><span class="c">wip</span><span class="p">  </span><span class="c">SUBJECT &quot;order confirmation&quot;</span><span class="p">  </span><span class="c">customerfolder</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="RPA.Email.ImapSmtp.ImapSmtp.rename_folder">
<span class="sig-name descname"><span class="pre">rename_folder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">oldname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suppress_error</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#RPA.Email.ImapSmtp.ImapSmtp.rename_folder" title="Link to this definition"></a></dt>
<dd><p>Rename email folder</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>oldname</strong> – current folder name</p></li>
<li><p><strong>newname</strong> – new name for the folder</p></li>
<li><p><strong>suppress_error</strong> – to silence warning message, defaults to False</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if operation was successful, False if not</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-robotframework notranslate"><div class="highlight"><pre><span></span><span class="c">Rename Folder</span><span class="p">   </span><span class="c">subfolder</span><span class="p">   </span><span class="c">filtered</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="RPA.Email.ImapSmtp.ImapSmtp.save_attachment">
<span class="sig-name descname"><span class="pre">save_attachment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Message</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_folder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#RPA.Email.ImapSmtp.ImapSmtp.save_attachment" title="Link to this definition"></a></dt>
<dd><p>Save mail attachment of a single given email on the local disk.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>message</strong> – message item</p></li>
<li><p><strong>target_folder</strong> – local folder for saving attachments to (needs to exist),
defaults to user’s home directory if None</p></li>
<li><p><strong>overwrite</strong> – overwrite existing file if True, defaults to False</p></li>
<li><p><strong>prefix</strong> – optional filename prefix added to the attachments, empty by
default</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list of saved attachments (list of absolute filepaths) in one email</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-robotframework notranslate"><div class="highlight"><pre><span></span><span class="c">@{emails} =</span><span class="p">    </span><span class="c">List Messages</span><span class="p">    </span><span class="c">ALL</span>
<span class="c">FOR</span><span class="p">    </span><span class="c">${email}</span><span class="p">    </span><span class="c">IN</span><span class="p">    </span><span class="c">@{emails}</span>
<span class="p">    </span><span class="c">IF</span><span class="p">    </span><span class="c">${email}[Has-Attachments]</span>
<span class="p">        </span><span class="c">Log To Console</span><span class="p">    </span><span class="c">Saving attachment for: ${email}[Subject]</span>
<span class="p">        </span><span class="c">${attachments} =</span><span class="p">    </span><span class="c">Save Attachment</span>
<span class="p">        </span><span class="c">...</span><span class="p">    </span><span class="c">${email}</span>
<span class="p">        </span><span class="c">...</span><span class="p">    </span><span class="c">target_folder=${CURDIR}</span>
<span class="p">        </span><span class="c">...</span><span class="p">    </span><span class="c">overwrite=${True}</span>
<span class="p">        </span><span class="c">Log To Console</span><span class="p">    </span><span class="c">Saved attachments: ${attachments}</span>
<span class="p">    </span><span class="c">END</span>
<span class="c">END</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="RPA.Email.ImapSmtp.ImapSmtp.save_attachments">
<span class="sig-name descname"><span class="pre">save_attachments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">criterion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_folder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#RPA.Email.ImapSmtp.ImapSmtp.save_attachments" title="Link to this definition"></a></dt>
<dd><p>Save mail attachments of emails matching criterion on the local disk.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>criterion</strong> – attachments are saved for mails matching this, defaults to “”</p></li>
<li><p><strong>target_folder</strong> – local folder for saving attachments to (needs to exist),
defaults to user’s home directory if None</p></li>
<li><p><strong>overwrite</strong> – overwrite existing file if True, defaults to False</p></li>
<li><p><strong>prefix</strong> – optional filename prefix added to the attachments, empty by
default</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list of saved attachments (absolute file paths) of all emails</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-robotframework notranslate"><div class="highlight"><pre><span></span><span class="c">${attachments} =</span><span class="p">    </span><span class="c">Save Attachments</span><span class="p">    </span><span class="c">SUBJECT &quot;rpa task&quot;</span>
<span class="c">...</span><span class="p">    </span><span class="c">target_folder=${CURDIR}${/}messages</span><span class="p">  </span><span class="c">overwrite=${True}</span>
<span class="c">FOR</span><span class="p">  </span><span class="c">${file}</span><span class="p">  </span><span class="c">IN</span><span class="p">  </span><span class="c">@{attachments}</span>
<span class="p">    </span><span class="c">OperatingSystem.File Should Exist</span><span class="p">  </span><span class="c">${file}</span>
<span class="c">END</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="RPA.Email.ImapSmtp.ImapSmtp.save_messages">
<span class="sig-name descname"><span class="pre">save_messages</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">criterion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_folder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#RPA.Email.ImapSmtp.ImapSmtp.save_messages" title="Link to this definition"></a></dt>
<dd><p>Save messages based on criteria and store them to target folder
with attachment files.</p>
<p>Does not save message if <cite>target_folder</cite> is not given.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>criterion</strong> – filter messages based on this, defaults to “”</p></li>
<li><p><strong>target_folder</strong> – path to folder where message are saved, defaults to None</p></li>
<li><p><strong>prefix</strong> – optional filename prefix added to the attachments, empty by
default</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if succeeded, False otherwise</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-robotframework notranslate"><div class="highlight"><pre><span></span><span class="c">Save Messages</span><span class="p">  </span><span class="c">SUBJECT Important message</span><span class="p">  </span><span class="c">target_folder=${USERDIR}${/}messages</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="RPA.Email.ImapSmtp.ImapSmtp.select_folder">
<span class="sig-name descname"><span class="pre">select_folder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'INBOX'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">readonly</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#RPA.Email.ImapSmtp.ImapSmtp.select_folder" title="Link to this definition"></a></dt>
<dd><p>Select folder by name</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>folder_name</strong> – name of the folder to select</p></li>
<li><p><strong>readonly</strong> – if set to True then message flags are not modified</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>message count in the selected folder</p>
</dd>
</dl>
<p>Returns number of messages in the folder or
exception if folder does not exist on the server.</p>
<p>Example:</p>
<div class="highlight-robotframework notranslate"><div class="highlight"><pre><span></span><span class="c">Select Folder</span><span class="p">   </span><span class="c">subfolder</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="RPA.Email.ImapSmtp.ImapSmtp.send_message">
<span class="sig-name descname"><span class="pre">send_message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sender</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recipients</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subject</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">body</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attachments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">html</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">images</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bcc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attachment_position</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AttachmentPosition</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">AttachmentPosition.TOP</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_reply_to</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reply_to</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#RPA.Email.ImapSmtp.ImapSmtp.send_message" title="Link to this definition"></a></dt>
<dd><p>Send SMTP email</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sender</strong> – who is sending, ie. ‘from’</p></li>
<li><p><strong>recipients</strong> – who is receiving, ie. ‘to’</p></li>
<li><p><strong>subject</strong> – mail subject field</p></li>
<li><p><strong>body</strong> – mail body content</p></li>
<li><p><strong>attachments</strong> – list of filepaths to attach</p></li>
<li><p><strong>html</strong> – if message content is in HTML, default <cite>False</cite></p></li>
<li><p><strong>images</strong> – list of filepaths for inline images</p></li>
<li><p><strong>cc</strong> – list of email addresses for email ‘cc’ field</p></li>
<li><p><strong>bcc</strong> – list of email addresses for email ‘bcc’ field</p></li>
<li><p><strong>attachment_position</strong> – content position for attachment, default <cite>top</cite></p></li>
<li><p><strong>in_reply_to</strong> – the ‘Message ID’ to which this message is in reply to,
for example <cite>&lt;message_id_for_reply_to&gt;</cite></p></li>
<li><p><strong>return_path</strong> – email address which should receive “bounce messages”</p></li>
<li><p><strong>reply_to</strong> – email address which should receive the reply</p></li>
</ul>
</dd>
</dl>
<p><strong>Valid sender values</strong></p>
<ul class="simple">
<li><p>First Lastname &lt;<a class="reference external" href="mailto:address&#37;&#52;&#48;domain">address<span>&#64;</span>domain</a>&gt;</p></li>
<li><p><a class="reference external" href="mailto:address&#37;&#52;&#48;domain">address<span>&#64;</span>domain</a></p></li>
</ul>
<p><strong>About in_reply_to</strong></p>
<p>In addition of setting <cite>in_reply_to</cite> parameter to match the ‘Message ID’
of the email this message is replying to, some email servers require that
also subject of the original email is included in the reply email subject
with <a href="#id1"><span class="problematic" id="id2">`</span></a>re: ` prefix, ie. “re: Why it is best to use Robocorp RPA” or with
the original email subject.</p>
<p>And please note that <cite>in_reply_to</cite> the ‘Message ID’ needs to contain <cite>&lt;</cite> in
the start of the ID and <cite>&gt;</cite> at the end of the ID.</p>
<p><strong>About return_path</strong></p>
<p>Email servers tend to set ‘Return-Path’ of the email on their own so in
some cases user given address won’t work as the email server does not
use the user set address. If possible, the email server’s configuration
can be changed to ensure that ‘Return-Path’ header is respected.</p>
<p>Example:</p>
<div class="highlight-robotframework notranslate"><div class="highlight"><pre><span></span><span class="c">Send Message</span><span class="p">  </span><span class="c">sender@domain.com</span><span class="p">  </span><span class="c">recipient@domain.com</span>
<span class="c">...</span><span class="p">           </span><span class="c">cc=need_to_know@domain.com</span>
<span class="c">...</span><span class="p">           </span><span class="c">bcc=hidden_copy@domain.com</span>
<span class="c">...</span><span class="p">           </span><span class="c">subject=Greetings Software Robot Developer</span>
<span class="c">...</span><span class="p">           </span><span class="c">body=${email_body}</span>
<span class="c">...</span><span class="p">           </span><span class="c">attachments=${CURDIR}${/}report.pdf</span>

<span class="c"># Fixing attachments to the bottom of the content</span>
<span class="c">Send Message</span><span class="p">  </span><span class="c">sender@domain.com</span><span class="p">  </span><span class="c">recipient@domain.com</span>
<span class="c">...</span><span class="p">           </span><span class="c">subject=Greetings Software Robot Developer</span>
<span class="c">...</span><span class="p">           </span><span class="c">body=${email_body}</span>
<span class="c">...</span><span class="p">           </span><span class="c">attachments=${CURDIR}${/}report.pdf</span>
<span class="c">...</span><span class="p">           </span><span class="c">attachment_position=bottom</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="RPA.Email.ImapSmtp.ImapSmtp.send_smtp_hello">
<span class="sig-name descname"><span class="pre">send_smtp_hello</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#RPA.Email.ImapSmtp.ImapSmtp.send_smtp_hello" title="Link to this definition"></a></dt>
<dd><p>Send hello message to SMTP server.</p>
<p>Required step when creating SMTP connection.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="RPA.Email.ImapSmtp.ImapSmtp.set_credentials">
<span class="sig-name descname"><span class="pre">set_credentials</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">account</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">password</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#RPA.Email.ImapSmtp.ImapSmtp.set_credentials" title="Link to this definition"></a></dt>
<dd><p>Set credentials</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>account</strong> – user account as string, defaults to None</p></li>
<li><p><strong>password</strong> – user password as string, defaults to None</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-robotframework notranslate"><div class="highlight"><pre><span></span><span class="c">Set Credentials</span><span class="p">   </span><span class="c">${username}</span><span class="p">   </span><span class="c">${password}</span>
<span class="c">Authorize</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="RPA.Email.ImapSmtp.ImapSmtp.unflag_messages">
<span class="sig-name descname"><span class="pre">unflag_messages</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">criterion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#RPA.Email.ImapSmtp.ImapSmtp.unflag_messages" title="Link to this definition"></a></dt>
<dd><p>Mark messages as not <cite>flagged</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>criterion</strong> – mark messages matching criterion</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>successful operations (int), matching messages (int)</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-robotframework notranslate"><div class="highlight"><pre><span></span><span class="c">${unflagged}</span><span class="p">  </span><span class="c">${oftotal}</span><span class="p">  </span><span class="c">Unflag Messages</span><span class="p">   </span><span class="c">SUBJECT rpa</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="RPA.Email.ImapSmtp.ImapSmtp.wait_for_message">
<span class="sig-name descname"><span class="pre">wait_for_message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">criterion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">readonly</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#RPA.Email.ImapSmtp.ImapSmtp.wait_for_message" title="Link to this definition"></a></dt>
<dd><p>Wait for email matching <cite>criterion</cite> to arrive into mailbox.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>criterion</strong> – message filter to wait for, defaults to “”</p></li>
<li><p><strong>timeout</strong> – total time in seconds to wait for email, defaults to 5.0</p></li>
<li><p><strong>interval</strong> – time in seconds for new check, defaults to 1.0</p></li>
<li><p><strong>readonly</strong> – set False if you want to mark matching messages as read</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list of messages</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-robotframework notranslate"><div class="highlight"><pre><span></span><span class="c">@{emails}</span><span class="p">  </span><span class="c">Wait For Message</span><span class="p">  </span><span class="c">SUBJECT &quot;rpa task&quot;</span><span class="p">  </span><span class="c">timeout=300</span><span class="p">  </span><span class="c">interval=10</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
	<div id="cookieConsentContainer">
  <div class="cookieDesc">
    <p>
      This website uses cookies to enhance the user experience.
      By using the website you accept the use of cookies.
      You can check our <a href="https://robocorp.com/privacy-policy">Privacy Policy</a> to learn more.
    </p>
  </div>
  <div class="cookieButton">
    <a onClick="cookieDismiss();">
      I understand
    </a>
  </div>
</div>
	<div id="robocorpBanner">
  <div id="bannerContent">
    <div id="bannerDismiss">
      <a onClick="bannerDismiss();">
        <img src="/_static/icon_cross.svg"/>
      </a>
    </div>
    <a href="https://robocorp.com">
      <img id="bannerLogo" src="https://cdn.robocorp.com/brand/Logo/Negative logo transparent/Negative logo transparent.svg"/>
    </a>
    <span id="bannerText">
      The automation stack for RPA Framework.
    </span>
    <a id="bannerButton" href="https://robocorp.com/get-started">
      Get started <img src="/_static/icon_arrow.svg"/>
    </a>
  </div>
</div>

          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Email.ImapSmtp" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../excel_application/index.html" class="btn btn-neutral float-right" title="Excel.Application" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025 Sema4.ai.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>